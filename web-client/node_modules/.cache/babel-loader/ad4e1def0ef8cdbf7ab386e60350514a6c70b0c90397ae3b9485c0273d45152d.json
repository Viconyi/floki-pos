{"ast":null,"code":"import _objectSpread from\"C:/Floki/web-client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React from'react';import{io}from'socket.io-client';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Track(_ref){var _trackOrders$ratingOr,_trackOrders$ratingOr2;let{trackOrders,setTrackOrders,config}=_ref;const[view,setView]=React.useState('current');const[expanded,setExpanded]=React.useState(null);// orderId\nconst[ratingOrderIndex,setRatingOrderIndex]=React.useState(null);const[itemRatings,setItemRatings]=React.useState({});// key: item idx -> {stars, comment}\nconst[deliveryRating,setDeliveryRating]=React.useState({stars:0,comment:''});const socketRef=React.useRef(null);React.useEffect(()=>{const socket=io('http://localhost:5000');socketRef.current=socket;socket.on('orderStatusUpdate',data=>{setTrackOrders(prev=>prev.map(o=>{var _data$etaMinutes;return o.id===data.orderId?_objectSpread(_objectSpread({},o),{},{status:data.status,etaMinutes:(_data$etaMinutes=data.etaMinutes)!==null&&_data$etaMinutes!==void 0?_data$etaMinutes:o.etaMinutes,driver:data.driver||o.driver,servedByName:data.servedByName||o.servedByName}):o;}));try{if(typeof window!=='undefined'&&'Notification'in window&&Notification.permission==='granted'){new Notification('Order Update',{body:\"Order status: \".concat(data.status)});}}catch(_unused){}});socket.on('locationUpdate',data=>{// Optional: update current order location if ids match\nif(data.orderId){setTrackOrders(prev=>prev.map(o=>o.id===data.orderId?_objectSpread(_objectSpread({},o),{},{location:data.location}):o));}});return()=>{socket.disconnect();};},[setTrackOrders]);// Auto-open rating modal when an order reaches final status (Completed/Delivered) and hasn't been prompted/rated.\nReact.useEffect(()=>{if(ratingOrderIndex!=null)return;const idx=trackOrders.findIndex(o=>o&&['Completed','Delivered'].includes(o.status)&&!o.ratingPrompted&&!o.rated);if(idx!==-1){setRatingOrderIndex(idx);setTrackOrders(prev=>prev.map((o,i)=>i===idx?_objectSpread(_objectSpread({},o),{},{ratingPrompted:true}):o));}},[trackOrders,ratingOrderIndex,setTrackOrders]);const currentOrders=trackOrders.filter(order=>!['Completed','Delivered'].includes(order.status));const pastOrders=trackOrders.filter(order=>['Completed','Delivered'].includes(order.status));function etaDisplay(order){if(!order.etaMinutes||!order.date)return'—';const etaMs=new Date(order.date).getTime()+order.etaMinutes*60*1000;const remainingMs=etaMs-Date.now();if(remainingMs<=0)return'Arriving now';const mins=Math.ceil(remainingMs/60000);return\"\".concat(mins,\" min\");}function progressPercent(order){var _map$order$status2;const isPickup=(order.deliveryType||'').toLowerCase()==='pickup';if(isPickup){var _map$order$status;const map={Pending:10,Preparing:50,Ready:90,Completed:100};return(_map$order$status=map[order.status])!==null&&_map$order$status!==void 0?_map$order$status:10;}const map={Pending:10,Preparing:40,'On the Way':75,Delivered:100};return(_map$order$status2=map[order.status])!==null&&_map$order$status2!==void 0?_map$order$status2:10;}const availableUtensils=Array.isArray(config===null||config===void 0?void 0:config.utensils)?config.utensils:[];const availableCondiments=Array.isArray(config===null||config===void 0?void 0:config.condiments)?config.condiments:[];const utensilPrices={Spoon:20,Plate:50,Cup:20};async function confirmOrder(oi){const order=trackOrders[oi];try{if(order.id){const res=await fetch(\"/api/hotel/orders/\".concat(order.id),{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify({status:'completed'})});const data=await res.json();if(!res.ok||data.error)throw new Error(data.error||'Failed to confirm');}}catch(_unused2){}setTrackOrders(prev=>prev.map((o,idx)=>idx===oi?_objectSpread(_objectSpread({},o),{},{status:'Completed'}):o));}function addItemUtensil(orderIndex,itemIndex,ut){if(!ut)return;setTrackOrders(prev=>prev.map((o,oi)=>{if(oi!==orderIndex)return o;const items=o.items.map((it,ii)=>{if(ii!==itemIndex)return it;if(it.utensils&&it.utensils.includes(ut))return it;const newUtensils=[...(it.utensils||[]),ut];const newTotal=(it.total||0)+(utensilPrices[ut]||0);return _objectSpread(_objectSpread({},it),{},{utensils:newUtensils,total:newTotal});});const newOrderTotal=(o.total||0)+(utensilPrices[ut]||0);return _objectSpread(_objectSpread({},o),{},{items,total:newOrderTotal});}));}function addItemCondiment(orderIndex,itemIndex,cond){if(!cond)return;setTrackOrders(prev=>prev.map((o,oi)=>{if(oi!==orderIndex)return o;const items=o.items.map((it,ii)=>{if(ii!==itemIndex)return it;if(it.condiments&&it.condiments.includes(cond))return it;const newConds=[...(it.condiments||[]),cond];return _objectSpread(_objectSpread({},it),{},{condiments:newConds});});return _objectSpread(_objectSpread({},o),{},{items});}));}return/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:800,margin:'2rem auto',background:'#fff',borderRadius:24,boxShadow:'0 4px 32px #0002',padding:'2.5rem',minHeight:300},children:[/*#__PURE__*/_jsx(\"h2\",{style:{color:'#1a2236',fontWeight:700,fontSize:32,marginBottom:24,textAlign:'center',letterSpacing:1},children:\"Your Orders\"}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center',marginBottom:32},children:/*#__PURE__*/_jsxs(\"div\",{style:{background:'#f7f7fa',borderRadius:12,boxShadow:'0 2px 8px #0001',padding:'6px 8px',display:'flex',gap:0},children:[/*#__PURE__*/_jsx(\"button\",{style:{background:view==='current'?'#ffb300':'transparent',color:view==='current'?'#222':'#888',border:'none',borderRadius:'12px 0 0 12px',padding:'12px 32px',fontWeight:700,fontSize:18,cursor:'pointer',boxShadow:view==='current'?'0 2px 8px #ffb30033':'none',transition:'background 0.2s'},onClick:()=>setView('current'),children:\"Current Orders\"}),/*#__PURE__*/_jsx(\"button\",{style:{background:view==='past'?'#ffb300':'transparent',color:view==='past'?'#222':'#888',border:'none',borderRadius:'0 12px 12px 0',padding:'12px 32px',fontWeight:700,fontSize:18,cursor:'pointer',boxShadow:view==='past'?'0 2px 8px #ffb30033':'none',transition:'background 0.2s'},onClick:()=>setView('past'),children:\"Past Orders\"})]})}),view==='current'?currentOrders.length>0?/*#__PURE__*/_jsx(\"div\",{style:{width:'100%'},children:currentOrders.map((order,idx)=>{var _order$driver,_order$driver2;return/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:36,padding:'24px 18px',borderRadius:18,background:'#f7f7fa',boxShadow:'0 2px 12px #0001',position:'relative'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:8},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setExpanded(expanded===(order.id||idx)?null:order.id||idx),style:{background:'transparent',border:'none',padding:0,cursor:'pointer'},children:/*#__PURE__*/_jsxs(\"div\",{style:{fontWeight:700,fontSize:22,color:'#1a2236'},children:[\"Order #\",idx+1]})}),/*#__PURE__*/_jsx(\"div\",{style:{color:'#888',fontSize:16},children:order.date?new Date(order.date).toLocaleString():''})]}),/*#__PURE__*/_jsxs(\"div\",{style:{fontWeight:600,fontSize:18,color:'#ffb300',marginBottom:8},children:[\"Status: \",order.status]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:12,marginBottom:12},children:[/*#__PURE__*/_jsx(\"div\",{style:{flex:1,height:10,background:'#e0e0e0',borderRadius:6,overflow:'hidden'},children:/*#__PURE__*/_jsx(\"div\",{style:{width:progressPercent(order)+'%',height:'100%',background:'#ffb300'}})}),/*#__PURE__*/_jsxs(\"div\",{style:{color:'#1a2236',fontWeight:600},children:[\"ETA: \",/*#__PURE__*/_jsx(\"span\",{style:{color:'#ffb300'},children:etaDisplay(order)})]})]}),order.status==='Delivery'&&/*#__PURE__*/_jsxs(\"div\",{style:{background:'#fff',border:'1px solid #eee',borderRadius:12,padding:'10px 12px',marginBottom:12},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,color:'#1a2236',marginBottom:6},children:\"Courier\"}),/*#__PURE__*/_jsxs(\"div\",{style:{color:'#555'},children:[\"Name: \",/*#__PURE__*/_jsx(\"span\",{style:{color:'#1a2236',fontWeight:600},children:((_order$driver=order.driver)===null||_order$driver===void 0?void 0:_order$driver.name)||'Assigned courier'})]}),/*#__PURE__*/_jsxs(\"div\",{style:{color:'#555'},children:[\"Contact: \",/*#__PURE__*/_jsx(\"span\",{style:{color:'#1a2236',fontWeight:600},children:((_order$driver2=order.driver)===null||_order$driver2===void 0?void 0:_order$driver2.phone)||'—'})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{fontWeight:600,fontSize:16,color:'#1a2236',marginBottom:8},children:[\"Payment: \",/*#__PURE__*/_jsx(\"span\",{style:{color:'#ffb300'},children:order.paymentMethod})]}),order.servedByName&&/*#__PURE__*/_jsxs(\"div\",{style:{fontWeight:600,fontSize:16,color:'#1a2236',marginBottom:8},children:[\"Served by: \",/*#__PURE__*/_jsx(\"span\",{style:{color:'#ffb300'},children:order.servedByName})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:16},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:600,fontSize:18,color:'#1a2236',marginBottom:6},children:\"Items\"}),/*#__PURE__*/_jsx(\"ul\",{style:{listStyle:'none',padding:0,margin:0},children:order.items.map((item,i)=>/*#__PURE__*/_jsxs(\"li\",{style:{display:'flex',alignItems:'center',marginBottom:10,background:'#fff',borderRadius:10,boxShadow:'0 1px 6px #0001',padding:'8px 12px'},children:[/*#__PURE__*/_jsx(\"img\",{src:item.img||'https://via.placeholder.com/40?text=No+Image',alt:item.name,style:{width:48,height:48,objectFit:'cover',borderRadius:10,marginRight:16}}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,fontSize:18,color:'#1a2236'},children:item.name}),/*#__PURE__*/_jsxs(\"div\",{style:{color:'#555',fontSize:15},children:[\"Qty: \",item.qty]}),/*#__PURE__*/_jsxs(\"div\",{style:{fontWeight:700,color:'#ffb300',fontSize:16,marginTop:2},children:[item.total,\" Ksh\"]}),item.utensils&&item.utensils.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#888',fontSize:14},children:[\"Utensils: \",item.utensils.join(', ')]}),item.condiments&&item.condiments.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#888',fontSize:14},children:[\"Condiments: \",item.condiments.join(', ')]}),item.notes&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#888',fontSize:14},children:[\"Notes: \",item.notes]}),item.deliveryNotes&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#888',fontSize:14},children:[\"Delivery Instructions: \",item.deliveryNotes]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:10,marginTop:8,flexWrap:'wrap'},children:[availableUtensils.length>0&&/*#__PURE__*/_jsxs(\"select\",{onChange:e=>{const v=e.target.value;e.target.selectedIndex=0;addItemUtensil(idx,i,v);},style:{padding:'6px 10px',borderRadius:8,border:'1px solid #eee'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Add Utility\"}),availableUtensils.map(ut=>/*#__PURE__*/_jsxs(\"option\",{value:ut,children:[ut,\" \",utensilPrices[ut]?\"(+\".concat(utensilPrices[ut],\" Ksh)\"):'']},ut))]}),availableCondiments.length>0&&/*#__PURE__*/_jsxs(\"select\",{onChange:e=>{const v=e.target.value;e.target.selectedIndex=0;addItemCondiment(idx,i,v);},style:{padding:'6px 10px',borderRadius:8,border:'1px solid #eee'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Add Condiment\"}),availableCondiments.map(cond=>/*#__PURE__*/_jsx(\"option\",{value:cond,children:cond},cond))]})]})]})]},i))})]}),expanded===(order.id||idx)&&/*#__PURE__*/_jsxs(\"div\",{style:{background:'#fff',borderRadius:12,border:'1px solid #eee',padding:'12px 14px',marginBottom:12},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,color:'#1a2236',marginBottom:8},children:\"Progress\"}),/*#__PURE__*/_jsx(\"ul\",{style:{listStyle:'none',padding:0,margin:0},children:((order.deliveryType||'').toLowerCase()==='pickup'?['Pending','Preparing','Ready','Completed']:['Pending','Preparing','On the Way','Delivered']).map(step=>/*#__PURE__*/_jsxs(\"li\",{style:{display:'flex',alignItems:'center',gap:8,marginBottom:6},children:[/*#__PURE__*/_jsx(\"span\",{style:{width:10,height:10,borderRadius:5,background:step===order.status?'#ffb300':'#e0e0e0'}}),/*#__PURE__*/_jsx(\"span\",{style:{color:step===order.status?'#1a2236':'#888',fontWeight:step===order.status?700:500},children:step})]},step))}),(order.deliveryType||'').toLowerCase()==='pickup'&&order.status==='Ready'?/*#__PURE__*/_jsx(\"button\",{onClick:()=>confirmOrder(idx),style:{background:'#1a2236',color:'#fff',border:'none',borderRadius:10,padding:'10px 16px',fontWeight:700,cursor:'pointer',marginTop:8},children:\"Confirm Received\"}):null]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:32,marginBottom:12},children:[/*#__PURE__*/_jsxs(\"div\",{style:{fontWeight:600,color:'#1a2236',fontSize:17},children:[\"Delivery Type: \",/*#__PURE__*/_jsx(\"span\",{style:{color:'#ffb300'},children:order.deliveryType})]}),/*#__PURE__*/_jsxs(\"div\",{style:{fontWeight:600,color:'#1a2236',fontSize:17},children:[\"Total: \",/*#__PURE__*/_jsxs(\"span\",{style:{color:'#ffb300'},children:[order.total,\" Ksh\"]})]})]}),order.canCancel&&/*#__PURE__*/_jsx(\"button\",{style:{background:'#e74c3c',color:'#fff',border:'none',borderRadius:10,padding:'10px 24px',fontWeight:700,fontSize:17,cursor:'pointer',marginBottom:12},onClick:()=>{setTrackOrders(prev=>prev.filter((_,i)=>i!==idx));},children:\"Cancel Order\"}),/*#__PURE__*/_jsx(\"div\",{style:{color:'#888',fontSize:15,marginBottom:4},children:/*#__PURE__*/_jsx(\"em\",{children:\"Thank you for your order! We'll keep you updated on its progress.\"})}),['Completed','Delivered'].includes(order.status)&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setRatingOrderIndex(idx);setItemRatings({});setDeliveryRating({stars:0,comment:''});},style:{background:'#ffb300',color:'#222',border:'none',borderRadius:10,padding:'10px 24px',fontWeight:700,fontSize:17,cursor:'pointer'},children:\"Rate Order\"})]},order.id||idx);})}):/*#__PURE__*/_jsx(\"div\",{style:{color:'#888',fontSize:22,fontWeight:600,textAlign:'center',marginTop:60},children:\"No current orders.\"}):pastOrders.length>0?/*#__PURE__*/_jsx(\"div\",{style:{width:'100%'},children:pastOrders.map((order,idx)=>/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:36,padding:'24px 18px',borderRadius:18,background:'#f7f7fa',boxShadow:'0 2px 12px #0001',position:'relative'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:8},children:[/*#__PURE__*/_jsxs(\"div\",{style:{fontWeight:700,fontSize:22,color:'#1a2236'},children:[\"Order #\",idx+1]}),/*#__PURE__*/_jsx(\"div\",{style:{color:'#888',fontSize:16},children:order.date?new Date(order.date).toLocaleString():''})]}),/*#__PURE__*/_jsxs(\"div\",{style:{fontWeight:600,fontSize:18,color:'#ffb300',marginBottom:8},children:[\"Status: \",order.status]}),/*#__PURE__*/_jsxs(\"div\",{style:{fontWeight:600,fontSize:16,color:'#1a2236',marginBottom:8},children:[\"Payment: \",/*#__PURE__*/_jsx(\"span\",{style:{color:'#ffb300'},children:order.paymentMethod})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:16},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:600,fontSize:18,color:'#1a2236',marginBottom:6},children:\"Items\"}),/*#__PURE__*/_jsx(\"ul\",{style:{listStyle:'none',padding:0,margin:0},children:order.items.map((item,i)=>/*#__PURE__*/_jsxs(\"li\",{style:{display:'flex',alignItems:'center',marginBottom:10,background:'#fff',borderRadius:10,boxShadow:'0 1px 6px #0001',padding:'8px 12px'},children:[/*#__PURE__*/_jsx(\"img\",{src:item.img||'https://via.placeholder.com/40?text=No+Image',alt:item.name,style:{width:48,height:48,objectFit:'cover',borderRadius:10,marginRight:16}}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,fontSize:18,color:'#1a2236'},children:item.name}),/*#__PURE__*/_jsxs(\"div\",{style:{color:'#555',fontSize:15},children:[\"Qty: \",item.qty]}),/*#__PURE__*/_jsxs(\"div\",{style:{fontWeight:700,color:'#ffb300',fontSize:16,marginTop:2},children:[item.total,\" Ksh\"]}),item.utensils&&item.utensils.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#888',fontSize:14},children:[\"Utensils: \",item.utensils.join(', ')]}),item.condiments&&item.condiments.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#888',fontSize:14},children:[\"Condiments: \",item.condiments.join(', ')]}),item.notes&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#888',fontSize:14},children:[\"Notes: \",item.notes]})]})]},i))})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:32,marginBottom:12},children:[/*#__PURE__*/_jsxs(\"div\",{style:{fontWeight:600,color:'#1a2236',fontSize:17},children:[\"Delivery Type: \",/*#__PURE__*/_jsx(\"span\",{style:{color:'#ffb300'},children:order.deliveryType})]}),/*#__PURE__*/_jsxs(\"div\",{style:{fontWeight:600,color:'#1a2236',fontSize:17},children:[\"Total: \",/*#__PURE__*/_jsxs(\"span\",{style:{color:'#ffb300'},children:[order.total,\" Ksh\"]})]})]}),/*#__PURE__*/_jsx(\"div\",{style:{color:'#888',fontSize:15,marginBottom:4},children:/*#__PURE__*/_jsx(\"em\",{children:\"Thank you for your order! We'll keep you updated on its progress.\"})})]},idx))}):/*#__PURE__*/_jsx(\"div\",{style:{color:'#888',fontSize:22,fontWeight:600,textAlign:'center',marginTop:60},children:\"No past orders.\"}),ratingOrderIndex!=null&&/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:0,left:0,width:'100vw',height:'100vh',background:'rgba(0,0,0,0.5)',zIndex:1000,display:'flex',alignItems:'center',justifyContent:'center'},children:/*#__PURE__*/_jsxs(\"div\",{style:{background:'#fff',borderRadius:16,padding:'2rem',maxWidth:560,width:'92vw',boxShadow:'0 4px 24px #0003'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{marginTop:0,fontSize:22,fontWeight:700,color:'#1a2236',marginBottom:12},children:\"Rate Your Order\"}),/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:12,color:'#6a708a'},children:\"Please rate each item and the delivery experience.\"}),(((_trackOrders$ratingOr=trackOrders[ratingOrderIndex])===null||_trackOrders$ratingOr===void 0?void 0:_trackOrders$ratingOr.items)||[]).map((item,i)=>{var _itemRatings$i,_itemRatings$i2;return/*#__PURE__*/_jsxs(\"div\",{style:{border:'1px solid #eef0f6',borderRadius:12,padding:12,marginBottom:10},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,color:'#1a2236'},children:item.name}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:8,alignItems:'center',marginTop:8},children:[/*#__PURE__*/_jsx(\"label\",{style:{color:'#6a708a'},children:\"Stars\"}),/*#__PURE__*/_jsxs(\"select\",{value:((_itemRatings$i=itemRatings[i])===null||_itemRatings$i===void 0?void 0:_itemRatings$i.stars)||0,onChange:e=>setItemRatings(r=>_objectSpread(_objectSpread({},r),{},{[i]:_objectSpread(_objectSpread({},r[i]||{}),{},{stars:Number(e.target.value)})})),style:{padding:'6px 10px',borderRadius:8,border:'1px solid #e1e4ee'},children:[/*#__PURE__*/_jsx(\"option\",{value:0,children:\"Select\"}),[1,2,3,4,5].map(s=>/*#__PURE__*/_jsx(\"option\",{value:s,children:s},s))]})]}),/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Comment\",value:((_itemRatings$i2=itemRatings[i])===null||_itemRatings$i2===void 0?void 0:_itemRatings$i2.comment)||'',onChange:e=>setItemRatings(r=>_objectSpread(_objectSpread({},r),{},{[i]:_objectSpread(_objectSpread({},r[i]||{}),{},{comment:e.target.value})})),style:{marginTop:8,width:'100%',minHeight:60,borderRadius:10,border:'1px solid #e1e4ee',padding:10}})]},i);}),(((_trackOrders$ratingOr2=trackOrders[ratingOrderIndex])===null||_trackOrders$ratingOr2===void 0?void 0:_trackOrders$ratingOr2.deliveryType)||'').toLowerCase()==='delivery'&&/*#__PURE__*/_jsxs(\"div\",{style:{border:'1px solid #eef0f6',borderRadius:12,padding:12,marginBottom:10},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,color:'#1a2236'},children:\"Delivery Experience\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:8,alignItems:'center',marginTop:8},children:[/*#__PURE__*/_jsx(\"label\",{style:{color:'#6a708a'},children:\"Stars\"}),/*#__PURE__*/_jsxs(\"select\",{value:deliveryRating.stars,onChange:e=>setDeliveryRating(_objectSpread(_objectSpread({},deliveryRating),{},{stars:Number(e.target.value)})),style:{padding:'6px 10px',borderRadius:8,border:'1px solid #e1e4ee'},children:[/*#__PURE__*/_jsx(\"option\",{value:0,children:\"Select\"}),[1,2,3,4,5].map(s=>/*#__PURE__*/_jsx(\"option\",{value:s,children:s},s))]})]}),/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Comment\",value:deliveryRating.comment,onChange:e=>setDeliveryRating(_objectSpread(_objectSpread({},deliveryRating),{},{comment:e.target.value})),style:{marginTop:8,width:'100%',minHeight:60,borderRadius:10,border:'1px solid #e1e4ee',padding:10}})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:8,justifyContent:'flex-end',marginTop:12},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setRatingOrderIndex(null);setItemRatings({});setDeliveryRating({stars:0,comment:''});},style:{padding:'8px 14px',borderRadius:10,border:'1px solid #e1e4ee',background:'#fff'},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:async()=>{const order=trackOrders[ratingOrderIndex];const promises=[];(order.items||[]).forEach((item,i)=>{const r=itemRatings[i];if(r&&r.stars>0){promises.push(fetch('/api/hotel/reviews',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({orderId:order.id,menuItem:item.id,type:'item',rating:r.stars,comment:r.comment||''})}));}});if((order.deliveryType||'').toLowerCase()==='delivery'&&deliveryRating.stars>0){promises.push(fetch('/api/hotel/reviews',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({orderId:order.id,type:'delivery',rating:deliveryRating.stars,comment:deliveryRating.comment||''})}));}try{await Promise.all(promises);}catch(_unused3){}// Mark order as rated to avoid future prompts\nsetTrackOrders(prev=>prev.map((o,i)=>i===ratingOrderIndex?_objectSpread(_objectSpread({},o),{},{rated:true}):o));setRatingOrderIndex(null);},style:{padding:'8px 14px',borderRadius:10,border:'none',background:'#1a2236',color:'#fff',fontWeight:700},children:\"Submit Ratings\"})]})]})})]});}export default Track;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}