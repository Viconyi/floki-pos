{"ast":null,"code":"// ETR generation endpoints\nAdminAPI.generateETR=orderId=>fetch(resolveUrl(\"/api/hotel/etr/\".concat(orderId))).then(res=>res.ok?res.text():Promise.reject('Failed to generate ETR'));AdminAPI.generateBulkETR=orderIds=>fetch(resolveUrl(\"/api/hotel/etr/bulk\"),{method:'POST',headers:jsonHeaders,body:JSON.stringify({orderIds})}).then(res=>res.ok?res.json():Promise.reject('Failed to generate bulk ETR'));const jsonHeaders={'Content-Type':'application/json'};function resolveUrl(url){if(/^https?:\\/\\//i.test(url))return url;const base=process.env.REACT_APP_API_BASE||'http://localhost:5000';if(url.startsWith('/'))return base+url;return base+'/'+url;}let errorHandler=null;export function setApiErrorHandler(fn){errorHandler=fn;}async function http(method,url,body){try{const res=await fetch(resolveUrl(url),{method,headers:body?jsonHeaders:undefined,body:body?JSON.stringify(body):undefined});if(!res.ok){const text=await res.text();const err=new Error(text||\"HTTP \".concat(res.status));if(errorHandler)errorHandler(err,{url,status:res.status});throw err;}if(errorHandler)errorHandler(null,{url,status:res.status});if(res.status===204)return null;const ct=res.headers.get('content-type')||'';if(ct.includes('application/json')){return res.json();}else{const text=await res.text();const err=new Error(text||'Unexpected non-JSON response');if(errorHandler)errorHandler(err,{url,status:res.status});throw err;}}catch(e){if(errorHandler)errorHandler(e,{url});throw e;}}export const AdminAPI={// Staff\nlistStaff:()=>http('GET','/api/admin/staff'),createStaff:payload=>http('POST','/api/admin/staff',payload),updateStaff:(id,payload)=>http('PUT',\"/api/admin/staff/\".concat(id),payload),deleteStaff:id=>http('DELETE',\"/api/admin/staff/\".concat(id)),// Orders (from hotel endpoints)\nlistOrders:()=>http('GET','/api/hotel/orders'),// Menu (available for future use)\nlistMenu:()=>http('GET','/api/admin/menu'),createMenuItem:payload=>http('POST','/api/admin/menu',payload),updateMenuItem:(id,payload)=>http('PUT',\"/api/admin/menu/\".concat(id),payload),deleteMenuItem:id=>http('DELETE',\"/api/admin/menu/\".concat(id)),// Till\ngetTill:()=>http('GET','/api/admin/till'),updateTill:payload=>http('PUT','/api/admin/till',payload)};export function formatDateTime(iso){try{const d=new Date(iso);return d.toLocaleString();}catch(_unused){return iso;}}export function formatCurrency(amount){const num=typeof amount==='number'&&Number.isFinite(amount)?amount:Number(amount||0);return\"Kshs \".concat(num.toLocaleString(undefined,{minimumFractionDigits:0,maximumFractionDigits:2}));}","map":{"version":3,"names":["AdminAPI","generateETR","orderId","fetch","resolveUrl","concat","then","res","ok","text","Promise","reject","generateBulkETR","orderIds","method","headers","jsonHeaders","body","JSON","stringify","json","url","test","base","process","env","REACT_APP_API_BASE","startsWith","errorHandler","setApiErrorHandler","fn","http","undefined","err","Error","status","ct","get","includes","e","listStaff","createStaff","payload","updateStaff","id","deleteStaff","listOrders","listMenu","createMenuItem","updateMenuItem","deleteMenuItem","getTill","updateTill","formatDateTime","iso","d","Date","toLocaleString","_unused","formatCurrency","amount","num","Number","isFinite","minimumFractionDigits","maximumFractionDigits"],"sources":["C:/Floki/web-admin/src/api.js"],"sourcesContent":["// ETR generation endpoints\r\nAdminAPI.generateETR = (orderId) => fetch(resolveUrl(`/api/hotel/etr/${orderId}`)).then(res => res.ok ? res.text() : Promise.reject('Failed to generate ETR'));\r\nAdminAPI.generateBulkETR = (orderIds) => fetch(resolveUrl(`/api/hotel/etr/bulk`), { method: 'POST', headers: jsonHeaders, body: JSON.stringify({ orderIds }) }).then(res => res.ok ? res.json() : Promise.reject('Failed to generate bulk ETR'));\r\nconst jsonHeaders = { 'Content-Type': 'application/json' };\r\n\r\nfunction resolveUrl(url) {\r\n  if (/^https?:\\/\\//i.test(url)) return url;\r\n  const base = process.env.REACT_APP_API_BASE || 'http://localhost:5000';\r\n  if (url.startsWith('/')) return base + url;\r\n  return base + '/' + url;\r\n}\r\n\r\nlet errorHandler = null;\r\nexport function setApiErrorHandler(fn) { errorHandler = fn; }\r\n\r\nasync function http(method, url, body) {\r\n  try {\r\n    const res = await fetch(resolveUrl(url), {\r\n      method,\r\n      headers: body ? jsonHeaders : undefined,\r\n      body: body ? JSON.stringify(body) : undefined,\r\n    });\r\n    if (!res.ok) {\r\n      const text = await res.text();\r\n      const err = new Error(text || `HTTP ${res.status}`);\r\n      if (errorHandler) errorHandler(err, { url, status: res.status });\r\n      throw err;\r\n    }\r\n    if (errorHandler) errorHandler(null, { url, status: res.status });\r\n    if (res.status === 204) return null;\r\n    const ct = res.headers.get('content-type') || '';\r\n    if (ct.includes('application/json')) {\r\n      return res.json();\r\n    } else {\r\n      const text = await res.text();\r\n      const err = new Error(text || 'Unexpected non-JSON response');\r\n      if (errorHandler) errorHandler(err, { url, status: res.status });\r\n      throw err;\r\n    }\r\n  } catch (e) {\r\n    if (errorHandler) errorHandler(e, { url });\r\n    throw e;\r\n  }\r\n}\r\n\r\nexport const AdminAPI = {\r\n  // Staff\r\n  listStaff: () => http('GET', '/api/admin/staff'),\r\n  createStaff: (payload) => http('POST', '/api/admin/staff', payload),\r\n  updateStaff: (id, payload) => http('PUT', `/api/admin/staff/${id}`, payload),\r\n  deleteStaff: (id) => http('DELETE', `/api/admin/staff/${id}`),\r\n\r\n  // Orders (from hotel endpoints)\r\n  listOrders: () => http('GET', '/api/hotel/orders'),\r\n\r\n  // Menu (available for future use)\r\n  listMenu: () => http('GET', '/api/admin/menu'),\r\n  createMenuItem: (payload) => http('POST', '/api/admin/menu', payload),\r\n  updateMenuItem: (id, payload) => http('PUT', `/api/admin/menu/${id}`, payload),\r\n  deleteMenuItem: (id) => http('DELETE', `/api/admin/menu/${id}`),\r\n\r\n  // Till\r\n  getTill: () => http('GET', '/api/admin/till'),\r\n  updateTill: (payload) => http('PUT', '/api/admin/till', payload),\r\n};\r\n\r\nexport function formatDateTime(iso) {\r\n  try {\r\n    const d = new Date(iso);\r\n    return d.toLocaleString();\r\n  } catch {\r\n    return iso;\r\n  }\r\n}\r\n\r\nexport function formatCurrency(amount) {\r\n  const num = typeof amount === 'number' && Number.isFinite(amount) ? amount : Number(amount || 0);\r\n  return `Kshs ${num.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 2 })}`;\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}