{"ast":null,"code":"const jsonHeaders = {\n  'Content-Type': 'application/json'\n};\nfunction resolveUrl(url) {\n  if (/^https?:\\/\\//i.test(url)) return url;\n  const base = process.env.REACT_APP_API_BASE || 'http://localhost:5000';\n  if (url.startsWith('/')) return base + url;\n  return base + '/' + url;\n}\nlet errorHandler = null;\nexport function setApiErrorHandler(fn) {\n  errorHandler = fn;\n}\nasync function http(method, url, body) {\n  try {\n    const res = await fetch(resolveUrl(url), {\n      method,\n      headers: body ? jsonHeaders : undefined,\n      body: body ? JSON.stringify(body) : undefined\n    });\n    if (!res.ok) {\n      const text = await res.text();\n      const err = new Error(text || `HTTP ${res.status}`);\n      if (errorHandler) errorHandler(err, {\n        url,\n        status: res.status\n      });\n      throw err;\n    }\n    if (errorHandler) errorHandler(null, {\n      url,\n      status: res.status\n    });\n    if (res.status === 204) return null;\n    const ct = res.headers.get('content-type') || '';\n    if (ct.includes('application/json')) {\n      return res.json();\n    } else {\n      const text = await res.text();\n      const err = new Error(text || 'Unexpected non-JSON response');\n      if (errorHandler) errorHandler(err, {\n        url,\n        status: res.status\n      });\n      throw err;\n    }\n  } catch (e) {\n    if (errorHandler) errorHandler(e, {\n      url\n    });\n    throw e;\n  }\n}\nexport const AdminAPI = {\n  // Staff\n  listStaff: () => http('GET', '/api/admin/staff'),\n  createStaff: payload => http('POST', '/api/admin/staff', payload),\n  updateStaff: (id, payload) => http('PUT', `/api/admin/staff/${id}`, payload),\n  deleteStaff: id => http('DELETE', `/api/admin/staff/${id}`),\n  // Orders (from hotel endpoints)\n  listOrders: () => http('GET', '/api/hotel/orders'),\n  // Menu (available for future use)\n  listMenu: () => http('GET', '/api/admin/menu'),\n  createMenuItem: payload => http('POST', '/api/admin/menu', payload),\n  updateMenuItem: (id, payload) => http('PUT', `/api/admin/menu/${id}`, payload),\n  deleteMenuItem: id => http('DELETE', `/api/admin/menu/${id}`),\n  // Till\n  getTill: () => http('GET', '/api/admin/till'),\n  updateTill: payload => http('PUT', '/api/admin/till', payload)\n};\nexport function formatDateTime(iso) {\n  try {\n    const d = new Date(iso);\n    return d.toLocaleString();\n  } catch {\n    return iso;\n  }\n}\nexport function formatCurrency(amount) {\n  const num = typeof amount === 'number' && Number.isFinite(amount) ? amount : Number(amount || 0);\n  return `Kshs ${num.toLocaleString(undefined, {\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 2\n  })}`;\n}","map":{"version":3,"names":["jsonHeaders","resolveUrl","url","test","base","process","env","REACT_APP_API_BASE","startsWith","errorHandler","setApiErrorHandler","fn","http","method","body","res","fetch","headers","undefined","JSON","stringify","ok","text","err","Error","status","ct","get","includes","json","e","AdminAPI","listStaff","createStaff","payload","updateStaff","id","deleteStaff","listOrders","listMenu","createMenuItem","updateMenuItem","deleteMenuItem","getTill","updateTill","formatDateTime","iso","d","Date","toLocaleString","formatCurrency","amount","num","Number","isFinite","minimumFractionDigits","maximumFractionDigits"],"sources":["C:/Floki/web-admin/src/api.js"],"sourcesContent":["const jsonHeaders = { 'Content-Type': 'application/json' };\r\n\r\nfunction resolveUrl(url) {\r\n  if (/^https?:\\/\\//i.test(url)) return url;\r\n  const base = process.env.REACT_APP_API_BASE || 'http://localhost:5000';\r\n  if (url.startsWith('/')) return base + url;\r\n  return base + '/' + url;\r\n}\r\n\r\nlet errorHandler = null;\r\nexport function setApiErrorHandler(fn) { errorHandler = fn; }\r\n\r\nasync function http(method, url, body) {\r\n  try {\r\n    const res = await fetch(resolveUrl(url), {\r\n      method,\r\n      headers: body ? jsonHeaders : undefined,\r\n      body: body ? JSON.stringify(body) : undefined,\r\n    });\r\n    if (!res.ok) {\r\n      const text = await res.text();\r\n      const err = new Error(text || `HTTP ${res.status}`);\r\n      if (errorHandler) errorHandler(err, { url, status: res.status });\r\n      throw err;\r\n    }\r\n    if (errorHandler) errorHandler(null, { url, status: res.status });\r\n    if (res.status === 204) return null;\r\n    const ct = res.headers.get('content-type') || '';\r\n    if (ct.includes('application/json')) {\r\n      return res.json();\r\n    } else {\r\n      const text = await res.text();\r\n      const err = new Error(text || 'Unexpected non-JSON response');\r\n      if (errorHandler) errorHandler(err, { url, status: res.status });\r\n      throw err;\r\n    }\r\n  } catch (e) {\r\n    if (errorHandler) errorHandler(e, { url });\r\n    throw e;\r\n  }\r\n}\r\n\r\nexport const AdminAPI = {\r\n  // Staff\r\n  listStaff: () => http('GET', '/api/admin/staff'),\r\n  createStaff: (payload) => http('POST', '/api/admin/staff', payload),\r\n  updateStaff: (id, payload) => http('PUT', `/api/admin/staff/${id}`, payload),\r\n  deleteStaff: (id) => http('DELETE', `/api/admin/staff/${id}`),\r\n\r\n  // Orders (from hotel endpoints)\r\n  listOrders: () => http('GET', '/api/hotel/orders'),\r\n\r\n  // Menu (available for future use)\r\n  listMenu: () => http('GET', '/api/admin/menu'),\r\n  createMenuItem: (payload) => http('POST', '/api/admin/menu', payload),\r\n  updateMenuItem: (id, payload) => http('PUT', `/api/admin/menu/${id}`, payload),\r\n  deleteMenuItem: (id) => http('DELETE', `/api/admin/menu/${id}`),\r\n\r\n  // Till\r\n  getTill: () => http('GET', '/api/admin/till'),\r\n  updateTill: (payload) => http('PUT', '/api/admin/till', payload),\r\n};\r\n\r\nexport function formatDateTime(iso) {\r\n  try {\r\n    const d = new Date(iso);\r\n    return d.toLocaleString();\r\n  } catch {\r\n    return iso;\r\n  }\r\n}\r\n\r\nexport function formatCurrency(amount) {\r\n  const num = typeof amount === 'number' && Number.isFinite(amount) ? amount : Number(amount || 0);\r\n  return `Kshs ${num.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 2 })}`;\r\n}"],"mappings":"AAAA,MAAMA,WAAW,GAAG;EAAE,cAAc,EAAE;AAAmB,CAAC;AAE1D,SAASC,UAAUA,CAACC,GAAG,EAAE;EACvB,IAAI,eAAe,CAACC,IAAI,CAACD,GAAG,CAAC,EAAE,OAAOA,GAAG;EACzC,MAAME,IAAI,GAAGC,OAAO,CAACC,GAAG,CAACC,kBAAkB,IAAI,uBAAuB;EACtE,IAAIL,GAAG,CAACM,UAAU,CAAC,GAAG,CAAC,EAAE,OAAOJ,IAAI,GAAGF,GAAG;EAC1C,OAAOE,IAAI,GAAG,GAAG,GAAGF,GAAG;AACzB;AAEA,IAAIO,YAAY,GAAG,IAAI;AACvB,OAAO,SAASC,kBAAkBA,CAACC,EAAE,EAAE;EAAEF,YAAY,GAAGE,EAAE;AAAE;AAE5D,eAAeC,IAAIA,CAACC,MAAM,EAAEX,GAAG,EAAEY,IAAI,EAAE;EACrC,IAAI;IACF,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAACf,UAAU,CAACC,GAAG,CAAC,EAAE;MACvCW,MAAM;MACNI,OAAO,EAAEH,IAAI,GAAGd,WAAW,GAAGkB,SAAS;MACvCJ,IAAI,EAAEA,IAAI,GAAGK,IAAI,CAACC,SAAS,CAACN,IAAI,CAAC,GAAGI;IACtC,CAAC,CAAC;IACF,IAAI,CAACH,GAAG,CAACM,EAAE,EAAE;MACX,MAAMC,IAAI,GAAG,MAAMP,GAAG,CAACO,IAAI,CAAC,CAAC;MAC7B,MAAMC,GAAG,GAAG,IAAIC,KAAK,CAACF,IAAI,IAAI,QAAQP,GAAG,CAACU,MAAM,EAAE,CAAC;MACnD,IAAIhB,YAAY,EAAEA,YAAY,CAACc,GAAG,EAAE;QAAErB,GAAG;QAAEuB,MAAM,EAAEV,GAAG,CAACU;MAAO,CAAC,CAAC;MAChE,MAAMF,GAAG;IACX;IACA,IAAId,YAAY,EAAEA,YAAY,CAAC,IAAI,EAAE;MAAEP,GAAG;MAAEuB,MAAM,EAAEV,GAAG,CAACU;IAAO,CAAC,CAAC;IACjE,IAAIV,GAAG,CAACU,MAAM,KAAK,GAAG,EAAE,OAAO,IAAI;IACnC,MAAMC,EAAE,GAAGX,GAAG,CAACE,OAAO,CAACU,GAAG,CAAC,cAAc,CAAC,IAAI,EAAE;IAChD,IAAID,EAAE,CAACE,QAAQ,CAAC,kBAAkB,CAAC,EAAE;MACnC,OAAOb,GAAG,CAACc,IAAI,CAAC,CAAC;IACnB,CAAC,MAAM;MACL,MAAMP,IAAI,GAAG,MAAMP,GAAG,CAACO,IAAI,CAAC,CAAC;MAC7B,MAAMC,GAAG,GAAG,IAAIC,KAAK,CAACF,IAAI,IAAI,8BAA8B,CAAC;MAC7D,IAAIb,YAAY,EAAEA,YAAY,CAACc,GAAG,EAAE;QAAErB,GAAG;QAAEuB,MAAM,EAAEV,GAAG,CAACU;MAAO,CAAC,CAAC;MAChE,MAAMF,GAAG;IACX;EACF,CAAC,CAAC,OAAOO,CAAC,EAAE;IACV,IAAIrB,YAAY,EAAEA,YAAY,CAACqB,CAAC,EAAE;MAAE5B;IAAI,CAAC,CAAC;IAC1C,MAAM4B,CAAC;EACT;AACF;AAEA,OAAO,MAAMC,QAAQ,GAAG;EACtB;EACAC,SAAS,EAAEA,CAAA,KAAMpB,IAAI,CAAC,KAAK,EAAE,kBAAkB,CAAC;EAChDqB,WAAW,EAAGC,OAAO,IAAKtB,IAAI,CAAC,MAAM,EAAE,kBAAkB,EAAEsB,OAAO,CAAC;EACnEC,WAAW,EAAEA,CAACC,EAAE,EAAEF,OAAO,KAAKtB,IAAI,CAAC,KAAK,EAAE,oBAAoBwB,EAAE,EAAE,EAAEF,OAAO,CAAC;EAC5EG,WAAW,EAAGD,EAAE,IAAKxB,IAAI,CAAC,QAAQ,EAAE,oBAAoBwB,EAAE,EAAE,CAAC;EAE7D;EACAE,UAAU,EAAEA,CAAA,KAAM1B,IAAI,CAAC,KAAK,EAAE,mBAAmB,CAAC;EAElD;EACA2B,QAAQ,EAAEA,CAAA,KAAM3B,IAAI,CAAC,KAAK,EAAE,iBAAiB,CAAC;EAC9C4B,cAAc,EAAGN,OAAO,IAAKtB,IAAI,CAAC,MAAM,EAAE,iBAAiB,EAAEsB,OAAO,CAAC;EACrEO,cAAc,EAAEA,CAACL,EAAE,EAAEF,OAAO,KAAKtB,IAAI,CAAC,KAAK,EAAE,mBAAmBwB,EAAE,EAAE,EAAEF,OAAO,CAAC;EAC9EQ,cAAc,EAAGN,EAAE,IAAKxB,IAAI,CAAC,QAAQ,EAAE,mBAAmBwB,EAAE,EAAE,CAAC;EAE/D;EACAO,OAAO,EAAEA,CAAA,KAAM/B,IAAI,CAAC,KAAK,EAAE,iBAAiB,CAAC;EAC7CgC,UAAU,EAAGV,OAAO,IAAKtB,IAAI,CAAC,KAAK,EAAE,iBAAiB,EAAEsB,OAAO;AACjE,CAAC;AAED,OAAO,SAASW,cAAcA,CAACC,GAAG,EAAE;EAClC,IAAI;IACF,MAAMC,CAAC,GAAG,IAAIC,IAAI,CAACF,GAAG,CAAC;IACvB,OAAOC,CAAC,CAACE,cAAc,CAAC,CAAC;EAC3B,CAAC,CAAC,MAAM;IACN,OAAOH,GAAG;EACZ;AACF;AAEA,OAAO,SAASI,cAAcA,CAACC,MAAM,EAAE;EACrC,MAAMC,GAAG,GAAG,OAAOD,MAAM,KAAK,QAAQ,IAAIE,MAAM,CAACC,QAAQ,CAACH,MAAM,CAAC,GAAGA,MAAM,GAAGE,MAAM,CAACF,MAAM,IAAI,CAAC,CAAC;EAChG,OAAO,QAAQC,GAAG,CAACH,cAAc,CAAC/B,SAAS,EAAE;IAAEqC,qBAAqB,EAAE,CAAC;IAAEC,qBAAqB,EAAE;EAAE,CAAC,CAAC,EAAE;AACxG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}