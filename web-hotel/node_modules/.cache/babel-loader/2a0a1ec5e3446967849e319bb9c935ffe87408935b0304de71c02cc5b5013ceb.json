{"ast":null,"code":"import _objectSpread from\"C:/Floki/web-hotel/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useMemo,useState}from'react';import{HotelAPI,formatCurrency,formatDateTime}from'../api';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function getStatusOptions(order){const isPickup=((order===null||order===void 0?void 0:order.deliveryType)||'').toLowerCase()==='pickup';return isPickup?['pending','preparing','ready','completed']:['pending','preparing','ready','on the way','delivered','cancelled'];}export default function OrdersPage(){var _confirmOrder$_id;const[orders,setOrders]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const[confirmOrder,setConfirmOrder]=useState(null);const[confirmMinutes,setConfirmMinutes]=useState('');const sections=['Pending','In Progress','Delivered','Cancelled'];const[selectedSection,setSelectedSection]=useState('Pending');const[expandedId,setExpandedId]=useState(null);async function load(){setLoading(true);setError('');try{const data=await HotelAPI.listOrders();setOrders(data.sort((a,b)=>new Date(b.createdAt)-new Date(a.createdAt)));}catch(e){setError(e.message||'Failed to load orders');}finally{setLoading(false);}}useEffect(()=>{load();},[]);const grouped=useMemo(()=>{const sorted=[...orders].sort((a,b)=>new Date(b.createdAt)-new Date(a.createdAt));const pending=sorted.filter(o=>o.status==='pending');const inProgress=sorted.filter(o=>['preparing','ready','on the way'].includes(o.status));const delivered=sorted.filter(o=>o.status==='delivered'||o.status==='completed');const cancelled=sorted.filter(o=>o.status==='cancelled');return{pending,inProgress,delivered,cancelled};},[orders]);async function updateStatus(id,status){try{let staffDisplayName=null;try{staffDisplayName=typeof localStorage!=='undefined'?localStorage.getItem('staffDisplayName'):null;}catch(_unused){}const payload=staffDisplayName?{status,servedByName:staffDisplayName}:{status};await HotelAPI.updateOrder(id,payload);setOrders(prev=>prev.map(o=>o._id===id?_objectSpread(_objectSpread({},o),{},{status}):o));}catch(e){alert(e.message||'Failed to update status');}}function handleStatusChange(order,nextStatus){if(order.status==='pending'){alert('Please confirm the order first and set duration.');return;}if(nextStatus==='delivered'){alert('Delivered is set automatically by the Delivery website.');return;}const requiresConfirm=['ready','on the way'].includes(nextStatus)||nextStatus==='cancelled';if(requiresConfirm){if(!window.confirm(\"Confirm change status to \\\"\".concat(nextStatus,\"\\\"?\")))return;}updateStatus(order._id,nextStatus);}async function handleConfirmSave(){if(!confirmOrder)return;const minutes=confirmMinutes===''?null:Number(confirmMinutes);try{let staffDisplayName=null;try{staffDisplayName=typeof localStorage!=='undefined'?localStorage.getItem('staffDisplayName'):null;}catch(_unused2){}const payload={status:'preparing'};if(minutes!=null&&!Number.isNaN(minutes))payload.etaMinutes=minutes;if(staffDisplayName)payload.servedByName=staffDisplayName;await HotelAPI.updateOrder(confirmOrder._id,payload);setOrders(prev=>prev.map(o=>o._id===confirmOrder._id?_objectSpread(_objectSpread({},o),{},{status:'preparing',etaMinutes:minutes!==null&&minutes!==void 0?minutes:o.etaMinutes,servedByName:staffDisplayName||o.servedByName}):o));setConfirmOrder(null);setConfirmMinutes('');}catch(e){alert(e.message||'Failed to confirm order');}}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:12,alignItems:'center',marginBottom:12},children:[/*#__PURE__*/_jsx(\"h2\",{style:{margin:0,color:'#1a2236'},children:\"Orders\"}),/*#__PURE__*/_jsxs(\"span\",{style:{color:'#8a8fa3'},children:[\"(\",orders.length,\")\"]}),/*#__PURE__*/_jsx(\"div\",{style:{marginLeft:'auto',display:'flex',gap:8},children:/*#__PURE__*/_jsx(\"button\",{onClick:load,style:{padding:'6px 12px',borderRadius:8,background:'#1a2236',color:'#fff',border:'none'},children:\"Refresh\"})})]}),loading&&/*#__PURE__*/_jsx(\"div\",{children:\"Loading\\u2026\"}),error&&/*#__PURE__*/_jsx(\"div\",{style:{color:'crimson'},children:error}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',gap:8,marginBottom:12,flexWrap:'wrap'},children:sections.map(sec=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedSection(sec),style:{padding:'8px 14px',borderRadius:999,border:selectedSection===sec?'none':'1px solid #dfe3ee',background:selectedSection===sec?'#1a2236':'#fff',color:selectedSection===sec?'#fff':'#1a2236',fontWeight:600},children:sec},sec))}),selectedSection==='Pending'&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:12},children:[/*#__PURE__*/_jsxs(\"h3\",{style:{margin:'8px 0',color:'#1a2236'},children:[\"Pending \",/*#__PURE__*/_jsxs(\"span\",{style:{color:'#8a8fa3'},children:[\"(\",grouped.pending.length,\")\"]})]}),grouped.pending.length===0&&!loading&&/*#__PURE__*/_jsx(\"div\",{style:{color:'#6a708a'},children:\"No pending orders.\"}),/*#__PURE__*/_jsx(\"div\",{style:{display:'grid',gridTemplateColumns:'1fr',gap:12},children:grouped.pending.map(order=>{var _order$_id,_order$items;return/*#__PURE__*/_jsxs(\"div\",{style:{border:'1px solid #eef0f6',borderRadius:12,padding:12},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:8,alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"strong\",{children:[\"#\",(_order$_id=order._id)===null||_order$_id===void 0?void 0:_order$_id.slice(-6)]}),/*#__PURE__*/_jsxs(\"span\",{style:{color:'#8a8fa3'},children:[\"\\u2022 \",formatDateTime(order.createdAt)]}),/*#__PURE__*/_jsx(\"span\",{style:{marginLeft:'auto',fontWeight:700},children:formatCurrency(order.total||0)})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:8,color:'#2a2f43'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[order.clientName||order.clientEmail||'Client',\" \\u2014 \",order.clientPhone||'N/A']}),order.servedByName&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#2a2f43'},children:[\"Served by: \",/*#__PURE__*/_jsx(\"strong\",{children:order.servedByName})]}),order.clientEmail&&/*#__PURE__*/_jsx(\"div\",{style:{color:'#6a708a'},children:order.clientEmail}),order.deliveryAddress&&/*#__PURE__*/_jsx(\"div\",{style:{color:'#6a708a'},children:order.deliveryAddress}),(()=>{const items=Array.isArray(order.items)?order.items:[];const ut=Array.from(new Set(items.flatMap(it=>Array.isArray(it.utensils)?it.utensils:[])));const cond=Array.from(new Set(items.flatMap(it=>Array.isArray(it.condiments)?it.condiments:[])));const packaging=items.filter(it=>{var _it$menuItem;return(((_it$menuItem=it.menuItem)===null||_it$menuItem===void 0?void 0:_it$menuItem.category)||it.category)==='Packaging';}).map(it=>{var _it$menuItem2;return((_it$menuItem2=it.menuItem)===null||_it$menuItem2===void 0?void 0:_it$menuItem2.name)||it.name;}).filter(Boolean);const notes=items.map(it=>it.notes).filter(Boolean);const dnotes=items.map(it=>it.deliveryNotes).filter(Boolean);return/*#__PURE__*/_jsxs(_Fragment,{children:[ut.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a'},children:[\"Utilities: \",ut.join(', ')]}),cond.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a'},children:[\"Condiments: \",cond.join(', ')]}),packaging.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a'},children:[\"Packaging: \",packaging.join(', ')]}),notes.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a'},children:[\"Notes: \",notes.join(' | ')]}),dnotes.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a'},children:[\"Delivery Instructions: \",dnotes.join(' | ')]})]});})()]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:8,display:'flex',gap:12,alignItems:'center',flexWrap:'wrap'},children:[/*#__PURE__*/_jsx(\"label\",{style:{color:'#6a708a'},children:\"Status\"}),/*#__PURE__*/_jsx(\"select\",{value:order.status,disabled:true,style:{padding:'6px 10px',borderRadius:8,border:'1px solid #e1e4ee'},children:getStatusOptions(order).map(s=>/*#__PURE__*/_jsx(\"option\",{value:s,children:s},s))}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{var _order$etaMinutes;setConfirmOrder(order);setConfirmMinutes(String((_order$etaMinutes=order.etaMinutes)!==null&&_order$etaMinutes!==void 0?_order$etaMinutes:''));},style:{padding:'6px 12px',borderRadius:8,background:'#ffb300',color:'#1a2236',border:'none'},children:\"Confirm + Set Duration\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setExpandedId(expandedId===order._id?null:order._id),style:{padding:'6px 12px',borderRadius:8,border:'1px solid #e1e4ee',background:'#fff'},children:expandedId===order._id?'Hide Details':'View Details'}),/*#__PURE__*/_jsxs(\"span\",{style:{marginLeft:'auto',color:'#6a708a'},children:[((_order$items=order.items)===null||_order$items===void 0?void 0:_order$items.length)||0,\" items\"]})]}),expandedId===order._id&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:10,background:'#fafbfe',border:'1px solid #eef0f6',borderRadius:10,padding:12},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,marginBottom:8,color:'#1a2236'},children:\"Items\"}),/*#__PURE__*/_jsx(\"ul\",{style:{listStyle:'none',padding:0,margin:0},children:(order.items||[]).map((it,i)=>{var _it$menuItem3,_it$menuItem4;const name=((_it$menuItem3=it.menuItem)===null||_it$menuItem3===void 0?void 0:_it$menuItem3.name)||it.name||'Item';const qty=it.quantity||it.qty||1;const price=(_it$menuItem4=it.menuItem)===null||_it$menuItem4===void 0?void 0:_it$menuItem4.price;const total=price!=null?price*qty:it.total!=null?it.total:null;return/*#__PURE__*/_jsx(\"li\",{style:{display:'flex',alignItems:'center',marginBottom:10,background:'#fff',borderRadius:10,boxShadow:'0 1px 6px #0001',padding:'8px 12px'},children:/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,color:'#1a2236'},children:name}),/*#__PURE__*/_jsxs(\"div\",{style:{color:'#555'},children:[\"Qty: \",qty]}),total!=null&&/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,color:'#ffb300'},children:formatCurrency(total)}),it.utensils&&it.utensils.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a',fontSize:13},children:[\"Utensils: \",it.utensils.join(', ')]}),it.condiments&&it.condiments.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a',fontSize:13},children:[\"Condiments: \",it.condiments.join(', ')]}),it.notes&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a',fontSize:13},children:[\"Notes: \",it.notes]}),it.deliveryNotes&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a',fontSize:13},children:[\"Delivery Instructions: \",it.deliveryNotes]})]})},i);})}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:16,marginTop:8,color:'#2a2f43',flexWrap:'wrap'},children:[order.paymentStatus&&/*#__PURE__*/_jsxs(\"div\",{children:[\"Payment: \",/*#__PURE__*/_jsx(\"span\",{style:{color:'#ffb300',fontWeight:600},children:order.paymentStatus})]}),order.etaMinutes!=null&&/*#__PURE__*/_jsxs(\"div\",{children:[\"ETA: \",/*#__PURE__*/_jsxs(\"span\",{style:{color:'#ffb300',fontWeight:600},children:[order.etaMinutes,\" min\"]})]})]})]})]},order._id);})})]}),selectedSection==='In Progress'&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:12},children:[/*#__PURE__*/_jsxs(\"h3\",{style:{margin:'8px 0',color:'#1a2236'},children:[\"In Progress \",/*#__PURE__*/_jsxs(\"span\",{style:{color:'#8a8fa3'},children:[\"(\",grouped.inProgress.length,\")\"]})]}),grouped.inProgress.length===0&&!loading&&/*#__PURE__*/_jsx(\"div\",{style:{color:'#6a708a'},children:\"No in-progress orders.\"}),/*#__PURE__*/_jsx(\"div\",{style:{display:'grid',gridTemplateColumns:'1fr',gap:12},children:grouped.inProgress.map(order=>{var _order$_id2,_order$items2;return/*#__PURE__*/_jsxs(\"div\",{style:{border:'1px solid #eef0f6',borderRadius:12,padding:12},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:8,alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"strong\",{children:[\"#\",(_order$_id2=order._id)===null||_order$_id2===void 0?void 0:_order$_id2.slice(-6)]}),/*#__PURE__*/_jsxs(\"span\",{style:{color:'#8a8fa3'},children:[\"\\u2022 \",formatDateTime(order.createdAt)]}),/*#__PURE__*/_jsx(\"span\",{style:{marginLeft:'auto',fontWeight:700},children:formatCurrency(order.total||0)})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:8,color:'#2a2f43'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[order.clientName||order.clientEmail||'Client',\" \\u2014 \",order.clientPhone||'N/A']}),order.servedByName&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#2a2f43'},children:[\"Served by: \",/*#__PURE__*/_jsx(\"strong\",{children:order.servedByName})]}),order.clientEmail&&/*#__PURE__*/_jsx(\"div\",{style:{color:'#6a708a'},children:order.clientEmail}),order.deliveryAddress&&/*#__PURE__*/_jsx(\"div\",{style:{color:'#6a708a'},children:order.deliveryAddress}),(()=>{const items=Array.isArray(order.items)?order.items:[];const ut=Array.from(new Set(items.flatMap(it=>Array.isArray(it.utensils)?it.utensils:[])));const cond=Array.from(new Set(items.flatMap(it=>Array.isArray(it.condiments)?it.condiments:[])));const packaging=items.filter(it=>{var _it$menuItem5;return(((_it$menuItem5=it.menuItem)===null||_it$menuItem5===void 0?void 0:_it$menuItem5.category)||it.category)==='Packaging';}).map(it=>{var _it$menuItem6;return((_it$menuItem6=it.menuItem)===null||_it$menuItem6===void 0?void 0:_it$menuItem6.name)||it.name;}).filter(Boolean);const notes=items.map(it=>it.notes).filter(Boolean);const dnotes=items.map(it=>it.deliveryNotes).filter(Boolean);return/*#__PURE__*/_jsxs(_Fragment,{children:[ut.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a'},children:[\"Utilities: \",ut.join(', ')]}),cond.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a'},children:[\"Condiments: \",cond.join(', ')]}),packaging.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a'},children:[\"Packaging: \",packaging.join(', ')]}),notes.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a'},children:[\"Notes: \",notes.join(' | ')]}),dnotes.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a'},children:[\"Delivery Instructions: \",dnotes.join(' | ')]})]});})()]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:8,display:'flex',gap:12,alignItems:'center',flexWrap:'wrap'},children:[/*#__PURE__*/_jsx(\"label\",{style:{color:'#6a708a'},children:\"Status\"}),/*#__PURE__*/_jsx(\"select\",{value:order.status,onChange:e=>handleStatusChange(order,e.target.value),style:{padding:'6px 10px',borderRadius:8,border:'1px solid #e1e4ee'},children:getStatusOptions(order).map(s=>/*#__PURE__*/_jsx(\"option\",{value:s,disabled:s==='delivered',children:s},s))}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setExpandedId(expandedId===order._id?null:order._id),style:{padding:'6px 12px',borderRadius:8,border:'1px solid #e1e4ee',background:'#fff'},children:expandedId===order._id?'Hide Details':'View Details'}),/*#__PURE__*/_jsxs(\"span\",{style:{marginLeft:'auto',color:'#6a708a'},children:[((_order$items2=order.items)===null||_order$items2===void 0?void 0:_order$items2.length)||0,\" items\"]})]}),expandedId===order._id&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:10,background:'#fafbfe',border:'1px solid #eef0f6',borderRadius:10,padding:12},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,marginBottom:8,color:'#1a2236'},children:\"Items\"}),/*#__PURE__*/_jsx(\"ul\",{style:{listStyle:'none',padding:0,margin:0},children:(order.items||[]).map((it,i)=>{var _it$menuItem7,_it$menuItem8;const name=((_it$menuItem7=it.menuItem)===null||_it$menuItem7===void 0?void 0:_it$menuItem7.name)||it.name||'Item';const qty=it.quantity||it.qty||1;const price=(_it$menuItem8=it.menuItem)===null||_it$menuItem8===void 0?void 0:_it$menuItem8.price;const total=price!=null?price*qty:it.total!=null?it.total:null;return/*#__PURE__*/_jsx(\"li\",{style:{display:'flex',alignItems:'center',marginBottom:10,background:'#fff',borderRadius:10,boxShadow:'0 1px 6px #0001',padding:'8px 12px'},children:/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,color:'#1a2236'},children:name}),/*#__PURE__*/_jsxs(\"div\",{style:{color:'#555'},children:[\"Qty: \",qty]}),total!=null&&/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,color:'#ffb300'},children:formatCurrency(total)}),it.utensils&&it.utensils.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a',fontSize:13},children:[\"Utensils: \",it.utensils.join(', ')]}),it.condiments&&it.condiments.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a',fontSize:13},children:[\"Condiments: \",it.condiments.join(', ')]}),it.notes&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a',fontSize:13},children:[\"Notes: \",it.notes]}),it.deliveryNotes&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a',fontSize:13},children:[\"Delivery Instructions: \",it.deliveryNotes]})]})},i);})}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:16,marginTop:8,color:'#2a2f43',flexWrap:'wrap'},children:[order.paymentStatus&&/*#__PURE__*/_jsxs(\"div\",{children:[\"Payment: \",/*#__PURE__*/_jsx(\"span\",{style:{color:'#ffb300',fontWeight:600},children:order.paymentStatus})]}),order.etaMinutes!=null&&/*#__PURE__*/_jsxs(\"div\",{children:[\"ETA: \",/*#__PURE__*/_jsxs(\"span\",{style:{color:'#ffb300',fontWeight:600},children:[order.etaMinutes,\" min\"]})]})]})]})]},order._id);})})]}),selectedSection==='Delivered'&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:12},children:[/*#__PURE__*/_jsxs(\"h3\",{style:{margin:'8px 0',color:'#1a2236'},children:[\"Delivered \",/*#__PURE__*/_jsxs(\"span\",{style:{color:'#8a8fa3'},children:[\"(\",grouped.delivered.length,\")\"]})]}),grouped.delivered.length===0&&!loading&&/*#__PURE__*/_jsx(\"div\",{style:{color:'#6a708a'},children:\"No delivered orders.\"}),/*#__PURE__*/_jsx(\"div\",{style:{display:'grid',gridTemplateColumns:'1fr',gap:12},children:grouped.delivered.map(order=>{var _order$_id3,_order$items3;return/*#__PURE__*/_jsxs(\"div\",{style:{border:'1px solid #eef0f6',borderRadius:12,padding:12},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:8,alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"strong\",{children:[\"#\",(_order$_id3=order._id)===null||_order$_id3===void 0?void 0:_order$_id3.slice(-6)]}),/*#__PURE__*/_jsxs(\"span\",{style:{color:'#8a8fa3'},children:[\"\\u2022 \",formatDateTime(order.createdAt)]}),/*#__PURE__*/_jsx(\"span\",{style:{marginLeft:'auto',fontWeight:700},children:formatCurrency(order.total||0)})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:8,color:'#2a2f43'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[order.clientName||order.clientEmail||'Client',\" \\u2014 \",order.clientPhone||'N/A']}),order.servedByName&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#2a2f43'},children:[\"Served by: \",/*#__PURE__*/_jsx(\"strong\",{children:order.servedByName})]}),order.clientEmail&&/*#__PURE__*/_jsx(\"div\",{style:{color:'#6a708a'},children:order.clientEmail}),order.deliveryAddress&&/*#__PURE__*/_jsx(\"div\",{style:{color:'#6a708a'},children:order.deliveryAddress}),(()=>{const items=Array.isArray(order.items)?order.items:[];const ut=Array.from(new Set(items.flatMap(it=>Array.isArray(it.utensils)?it.utensils:[])));const cond=Array.from(new Set(items.flatMap(it=>Array.isArray(it.condiments)?it.condiments:[])));const packaging=items.filter(it=>{var _it$menuItem9;return(((_it$menuItem9=it.menuItem)===null||_it$menuItem9===void 0?void 0:_it$menuItem9.category)||it.category)==='Packaging';}).map(it=>{var _it$menuItem0;return((_it$menuItem0=it.menuItem)===null||_it$menuItem0===void 0?void 0:_it$menuItem0.name)||it.name;}).filter(Boolean);const notes=items.map(it=>it.notes).filter(Boolean);const dnotes=items.map(it=>it.deliveryNotes).filter(Boolean);return/*#__PURE__*/_jsxs(_Fragment,{children:[ut.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a'},children:[\"Utilities: \",ut.join(', ')]}),cond.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a'},children:[\"Condiments: \",cond.join(', ')]}),packaging.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a'},children:[\"Packaging: \",packaging.join(', ')]}),notes.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a'},children:[\"Notes: \",notes.join(' | ')]}),dnotes.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a'},children:[\"Delivery Instructions: \",dnotes.join(' | ')]})]});})()]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:8,display:'flex',gap:12,alignItems:'center',flexWrap:'wrap'},children:[/*#__PURE__*/_jsx(\"label\",{style:{color:'#6a708a'},children:\"Status\"}),/*#__PURE__*/_jsx(\"select\",{value:order.status,disabled:true,style:{padding:'6px 10px',borderRadius:8,border:'1px solid #e1e4ee'},children:getStatusOptions(order).map(s=>/*#__PURE__*/_jsx(\"option\",{value:s,children:s},s))}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setExpandedId(expandedId===order._id?null:order._id),style:{padding:'6px 12px',borderRadius:8,border:'1px solid #e1e4ee',background:'#fff'},children:expandedId===order._id?'Hide Details':'View Details'}),/*#__PURE__*/_jsxs(\"span\",{style:{marginLeft:'auto',color:'#6a708a'},children:[((_order$items3=order.items)===null||_order$items3===void 0?void 0:_order$items3.length)||0,\" items\"]})]}),expandedId===order._id&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:10,background:'#fafbfe',border:'1px solid #eef0f6',borderRadius:10,padding:12},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,marginBottom:8,color:'#1a2236'},children:\"Items\"}),/*#__PURE__*/_jsx(\"ul\",{style:{listStyle:'none',padding:0,margin:0},children:(order.items||[]).map((it,i)=>{var _it$menuItem1,_it$menuItem10;const name=((_it$menuItem1=it.menuItem)===null||_it$menuItem1===void 0?void 0:_it$menuItem1.name)||it.name||'Item';const qty=it.quantity||it.qty||1;const price=(_it$menuItem10=it.menuItem)===null||_it$menuItem10===void 0?void 0:_it$menuItem10.price;const total=price!=null?price*qty:it.total!=null?it.total:null;return/*#__PURE__*/_jsx(\"li\",{style:{display:'flex',alignItems:'center',marginBottom:10,background:'#fff',borderRadius:10,boxShadow:'0 1px 6px #0001',padding:'8px 12px'},children:/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,color:'#1a2236'},children:name}),/*#__PURE__*/_jsxs(\"div\",{style:{color:'#555'},children:[\"Qty: \",qty]}),total!=null&&/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,color:'#ffb300'},children:formatCurrency(total)}),it.utensils&&it.utensils.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a',fontSize:13},children:[\"Utensils: \",it.utensils.join(', ')]}),it.condiments&&it.condiments.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a',fontSize:13},children:[\"Condiments: \",it.condiments.join(', ')]}),it.notes&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a',fontSize:13},children:[\"Notes: \",it.notes]}),it.deliveryNotes&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a',fontSize:13},children:[\"Delivery Instructions: \",it.deliveryNotes]})]})},i);})}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:16,marginTop:8,color:'#2a2f43',flexWrap:'wrap'},children:[order.paymentStatus&&/*#__PURE__*/_jsxs(\"div\",{children:[\"Payment: \",/*#__PURE__*/_jsx(\"span\",{style:{color:'#ffb300',fontWeight:600},children:order.paymentStatus})]}),order.etaMinutes!=null&&/*#__PURE__*/_jsxs(\"div\",{children:[\"ETA: \",/*#__PURE__*/_jsxs(\"span\",{style:{color:'#ffb300',fontWeight:600},children:[order.etaMinutes,\" min\"]})]})]})]})]},order._id);})})]}),selectedSection==='Cancelled'&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:12},children:[/*#__PURE__*/_jsxs(\"h3\",{style:{margin:'8px 0',color:'#1a2236'},children:[\"Cancelled \",/*#__PURE__*/_jsxs(\"span\",{style:{color:'#8a8fa3'},children:[\"(\",grouped.cancelled.length,\")\"]})]}),grouped.cancelled.length===0&&!loading&&/*#__PURE__*/_jsx(\"div\",{style:{color:'#6a708a'},children:\"No cancelled orders.\"}),/*#__PURE__*/_jsx(\"div\",{style:{display:'grid',gridTemplateColumns:'1fr',gap:12},children:grouped.cancelled.map(order=>{var _order$_id4,_order$items4;return/*#__PURE__*/_jsxs(\"div\",{style:{border:'1px solid #eef0f6',borderRadius:12,padding:12},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:8,alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"strong\",{children:[\"#\",(_order$_id4=order._id)===null||_order$_id4===void 0?void 0:_order$_id4.slice(-6)]}),/*#__PURE__*/_jsxs(\"span\",{style:{color:'#8a8fa3'},children:[\"\\u2022 \",formatDateTime(order.createdAt)]}),/*#__PURE__*/_jsx(\"span\",{style:{marginLeft:'auto',fontWeight:700},children:formatCurrency(order.total||0)})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:8,color:'#2a2f43'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[order.clientName||order.clientEmail||'Client',\" \\u2014 \",order.clientPhone||'N/A']}),order.servedByName&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#2a2f43'},children:[\"Served by: \",/*#__PURE__*/_jsx(\"strong\",{children:order.servedByName})]}),order.clientEmail&&/*#__PURE__*/_jsx(\"div\",{style:{color:'#6a708a'},children:order.clientEmail}),order.deliveryAddress&&/*#__PURE__*/_jsx(\"div\",{style:{color:'#6a708a'},children:order.deliveryAddress}),(()=>{const items=Array.isArray(order.items)?order.items:[];const ut=Array.from(new Set(items.flatMap(it=>Array.isArray(it.utensils)?it.utensils:[])));const cond=Array.from(new Set(items.flatMap(it=>Array.isArray(it.condiments)?it.condiments:[])));const packaging=items.filter(it=>{var _it$menuItem11;return(((_it$menuItem11=it.menuItem)===null||_it$menuItem11===void 0?void 0:_it$menuItem11.category)||it.category)==='Packaging';}).map(it=>{var _it$menuItem12;return((_it$menuItem12=it.menuItem)===null||_it$menuItem12===void 0?void 0:_it$menuItem12.name)||it.name;}).filter(Boolean);const notes=items.map(it=>it.notes).filter(Boolean);const dnotes=items.map(it=>it.deliveryNotes).filter(Boolean);return/*#__PURE__*/_jsxs(_Fragment,{children:[ut.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a'},children:[\"Utilities: \",ut.join(', ')]}),cond.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a'},children:[\"Condiments: \",cond.join(', ')]}),packaging.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a'},children:[\"Packaging: \",packaging.join(', ')]}),notes.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a'},children:[\"Notes: \",notes.join(' | ')]}),dnotes.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a'},children:[\"Delivery Instructions: \",dnotes.join(' | ')]})]});})()]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:8,display:'flex',gap:12,alignItems:'center',flexWrap:'wrap'},children:[/*#__PURE__*/_jsx(\"label\",{style:{color:'#6a708a'},children:\"Status\"}),/*#__PURE__*/_jsx(\"select\",{value:order.status,disabled:true,style:{padding:'6px 10px',borderRadius:8,border:'1px solid #e1e4ee'},children:getStatusOptions(order).map(s=>/*#__PURE__*/_jsx(\"option\",{value:s,children:s},s))}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setExpandedId(expandedId===order._id?null:order._id),style:{padding:'6px 12px',borderRadius:8,border:'1px solid #e1e4ee',background:'#fff'},children:expandedId===order._id?'Hide Details':'View Details'}),/*#__PURE__*/_jsxs(\"span\",{style:{marginLeft:'auto',color:'#6a708a'},children:[((_order$items4=order.items)===null||_order$items4===void 0?void 0:_order$items4.length)||0,\" items\"]})]}),expandedId===order._id&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:10,background:'#fafbfe',border:'1px solid #eef0f6',borderRadius:10,padding:12},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,marginBottom:8,color:'#1a2236'},children:\"Items\"}),/*#__PURE__*/_jsx(\"ul\",{style:{listStyle:'none',padding:0,margin:0},children:(order.items||[]).map((it,i)=>{var _it$menuItem13,_it$menuItem14;const name=((_it$menuItem13=it.menuItem)===null||_it$menuItem13===void 0?void 0:_it$menuItem13.name)||it.name||'Item';const qty=it.quantity||it.qty||1;const price=(_it$menuItem14=it.menuItem)===null||_it$menuItem14===void 0?void 0:_it$menuItem14.price;const total=price!=null?price*qty:it.total!=null?it.total:null;return/*#__PURE__*/_jsx(\"li\",{style:{display:'flex',alignItems:'center',marginBottom:10,background:'#fff',borderRadius:10,boxShadow:'0 1px 6px #0001',padding:'8px 12px'},children:/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,color:'#1a2236'},children:name}),/*#__PURE__*/_jsxs(\"div\",{style:{color:'#555'},children:[\"Qty: \",qty]}),total!=null&&/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,color:'#ffb300'},children:formatCurrency(total)}),it.utensils&&it.utensils.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a',fontSize:13},children:[\"Utensils: \",it.utensils.join(', ')]}),it.condiments&&it.condiments.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a',fontSize:13},children:[\"Condiments: \",it.condiments.join(', ')]}),it.notes&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a',fontSize:13},children:[\"Notes: \",it.notes]}),it.deliveryNotes&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#6a708a',fontSize:13},children:[\"Delivery Instructions: \",it.deliveryNotes]})]})},i);})}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:16,marginTop:8,color:'#2a2f43',flexWrap:'wrap'},children:[order.paymentStatus&&/*#__PURE__*/_jsxs(\"div\",{children:[\"Payment: \",/*#__PURE__*/_jsx(\"span\",{style:{color:'#ffb300',fontWeight:600},children:order.paymentStatus})]}),order.etaMinutes!=null&&/*#__PURE__*/_jsxs(\"div\",{children:[\"ETA: \",/*#__PURE__*/_jsxs(\"span\",{style:{color:'#ffb300',fontWeight:600},children:[order.etaMinutes,\" min\"]})]})]})]})]},order._id);})})]}),confirmOrder&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:12,border:'1px solid #ffe6b3',background:'#fff8e6',borderRadius:12,padding:12},children:[/*#__PURE__*/_jsxs(\"div\",{style:{fontWeight:700,marginBottom:8},children:[\"Confirm Order #\",(_confirmOrder$_id=confirmOrder._id)===null||_confirmOrder$_id===void 0?void 0:_confirmOrder$_id.slice(-6)]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gap:10},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',fontSize:12,color:'#6a708a'},children:\"Preparation Duration (minutes)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",step:\"1\",value:confirmMinutes,onChange:e=>setConfirmMinutes(e.target.value),style:{width:'100%',padding:8,borderRadius:8,border:'1px solid #e1e4ee'}})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:8,justifyContent:'flex-end'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setConfirmOrder(null);setConfirmMinutes('');},style:{padding:'6px 12px',borderRadius:8,border:'1px solid #dfe3ee',background:'#fff'},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleConfirmSave,style:{padding:'6px 12px',borderRadius:8,border:'none',background:'#1a2236',color:'#fff'},children:\"Confirm\"})]})]})]})]});}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}