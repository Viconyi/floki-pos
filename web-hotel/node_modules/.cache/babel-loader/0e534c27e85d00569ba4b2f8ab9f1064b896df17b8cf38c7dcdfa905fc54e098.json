{"ast":null,"code":"import _objectSpread from\"C:/Floki/web-hotel/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";const jsonHeaders={'Content-Type':'application/json'};let authToken=null;export function setAuthToken(token){authToken=token||null;}function getAuthToken(){try{if(authToken)return authToken;if(typeof localStorage!=='undefined'){return localStorage.getItem('staffToken');}return null;}catch(_unused){return authToken;}}let errorHandler=null;export function setApiErrorHandler(fn){errorHandler=fn;}const API_BASE=process.env.REACT_APP_API_BASE||'';function resolveUrl(url){if(/^https?:\\/\\//i.test(url))return url;if(!API_BASE)return url;if(url.startsWith('/'))return API_BASE+url;return API_BASE+'/'+url;}async function http(method,url,body){try{const headers=body?_objectSpread({},jsonHeaders):{};const token=getAuthToken();if(token)headers['Authorization']=\"Bearer \".concat(token);const res=await fetch(resolveUrl(url),{method,headers:Object.keys(headers).length?headers:undefined,body:body?JSON.stringify(body):undefined});if(!res.ok){const text=await res.text();const err=new Error(text||\"HTTP \".concat(res.status));if(errorHandler)errorHandler(err,{url,status:res.status});throw err;}if(errorHandler)errorHandler(null,{url,status:res.status});// 204 no content\nif(res.status===204)return null;return res.json();}catch(e){if(errorHandler)errorHandler(e,{url});throw e;}}export const HotelAPI={// Orders\nlistOrders:()=>http('GET','/api/hotel/orders'),updateOrder:(id,payload)=>http('PUT',\"/api/hotel/orders/\".concat(id),payload),createOrder:payload=>http('POST','/api/hotel/orders',payload),// Menu (admin endpoints)\nlistMenu:()=>http('GET','/api/admin/menu'),createMenuItem:payload=>http('POST','/api/admin/menu',payload),updateMenuItem:(id,payload)=>http('PUT',\"/api/admin/menu/\".concat(id),payload),deleteMenuItem:id=>http('DELETE',\"/api/admin/menu/\".concat(id)),// Auth\nlogin:(username,pin)=>http('POST','/api/hotel/auth/login',{username,pin}),logout:()=>http('POST','/api/hotel/auth/logout'),// MPESA QR\ngenerateQR:payload=>http('POST','/api/mpesa/qrcode',payload)};export function formatCurrency(amount){if(typeof amount!=='number')return amount;// Use Kenyan Shillings display as \"Kshs\" per requirements\nconst num=Number.isFinite(amount)?amount:0;return\"Kshs \".concat(num.toLocaleString(undefined,{minimumFractionDigits:0,maximumFractionDigits:2}));}export function formatDateTime(iso){try{const d=new Date(iso);return d.toLocaleString();}catch(_unused2){return iso;}}","map":{"version":3,"names":["jsonHeaders","authToken","setAuthToken","token","getAuthToken","localStorage","getItem","_unused","errorHandler","setApiErrorHandler","fn","API_BASE","process","env","REACT_APP_API_BASE","resolveUrl","url","test","startsWith","http","method","body","headers","_objectSpread","concat","res","fetch","Object","keys","length","undefined","JSON","stringify","ok","text","err","Error","status","json","e","HotelAPI","listOrders","updateOrder","id","payload","createOrder","listMenu","createMenuItem","updateMenuItem","deleteMenuItem","login","username","pin","logout","generateQR","formatCurrency","amount","num","Number","isFinite","toLocaleString","minimumFractionDigits","maximumFractionDigits","formatDateTime","iso","d","Date","_unused2"],"sources":["C:/Floki/web-hotel/src/api.js"],"sourcesContent":["const jsonHeaders = { 'Content-Type': 'application/json' };\r\n\r\nlet authToken = null;\r\nexport function setAuthToken(token) { authToken = token || null; }\r\nfunction getAuthToken() {\r\n  try {\r\n    if (authToken) return authToken;\r\n    if (typeof localStorage !== 'undefined') {\r\n      return localStorage.getItem('staffToken');\r\n    }\r\n    return null;\r\n  } catch {\r\n    return authToken;\r\n  }\r\n}\r\n\r\nlet errorHandler = null;\r\nexport function setApiErrorHandler(fn) { errorHandler = fn; }\r\n\r\nconst API_BASE = process.env.REACT_APP_API_BASE || '';\r\n\r\nfunction resolveUrl(url) {\r\n  if (/^https?:\\/\\//i.test(url)) return url;\r\n  if (!API_BASE) return url;\r\n  if (url.startsWith('/')) return API_BASE + url;\r\n  return API_BASE + '/' + url;\r\n}\r\n\r\nasync function http(method, url, body) {\r\n  try {\r\n    const headers = body ? { ...jsonHeaders } : {};\r\n    const token = getAuthToken();\r\n    if (token) headers['Authorization'] = `Bearer ${token}`;\r\n    const res = await fetch(resolveUrl(url), {\r\n      method,\r\n      headers: Object.keys(headers).length ? headers : undefined,\r\n      body: body ? JSON.stringify(body) : undefined,\r\n    });\r\n    if (!res.ok) {\r\n      const text = await res.text();\r\n      const err = new Error(text || `HTTP ${res.status}`);\r\n      if (errorHandler) errorHandler(err, { url, status: res.status });\r\n      throw err;\r\n    }\r\n    if (errorHandler) errorHandler(null, { url, status: res.status });\r\n    // 204 no content\r\n    if (res.status === 204) return null;\r\n    return res.json();\r\n  } catch (e) {\r\n    if (errorHandler) errorHandler(e, { url });\r\n    throw e;\r\n  }\r\n}\r\n\r\nexport const HotelAPI = {\r\n  // Orders\r\n  listOrders: () => http('GET', '/api/hotel/orders'),\r\n  updateOrder: (id, payload) => http('PUT', `/api/hotel/orders/${id}`, payload),\r\n  createOrder: (payload) => http('POST', '/api/hotel/orders', payload),\r\n\r\n  // Menu (admin endpoints)\r\n  listMenu: () => http('GET', '/api/admin/menu'),\r\n  createMenuItem: (payload) => http('POST', '/api/admin/menu', payload),\r\n  updateMenuItem: (id, payload) => http('PUT', `/api/admin/menu/${id}`, payload),\r\n  deleteMenuItem: (id) => http('DELETE', `/api/admin/menu/${id}`),\r\n\r\n  // Auth\r\n  login: (username, pin) => http('POST', '/api/hotel/auth/login', { username, pin }),\r\n  logout: () => http('POST', '/api/hotel/auth/logout'),\r\n\r\n  // MPESA QR\r\n  generateQR: (payload) => http('POST', '/api/mpesa/qrcode', payload),\r\n};\r\n\r\nexport function formatCurrency(amount) {\r\n  if (typeof amount !== 'number') return amount;\r\n  // Use Kenyan Shillings display as \"Kshs\" per requirements\r\n  const num = Number.isFinite(amount) ? amount : 0;\r\n  return `Kshs ${num.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 2 })}`;\r\n}\r\n\r\nexport function formatDateTime(iso) {\r\n  try {\r\n    const d = new Date(iso);\r\n    return d.toLocaleString();\r\n  } catch {\r\n    return iso;\r\n  }\r\n}\r\n"],"mappings":"uGAAA,KAAM,CAAAA,WAAW,CAAG,CAAE,cAAc,CAAE,kBAAmB,CAAC,CAE1D,GAAI,CAAAC,SAAS,CAAG,IAAI,CACpB,MAAO,SAAS,CAAAC,YAAYA,CAACC,KAAK,CAAE,CAAEF,SAAS,CAAGE,KAAK,EAAI,IAAI,CAAE,CACjE,QAAS,CAAAC,YAAYA,CAAA,CAAG,CACtB,GAAI,CACF,GAAIH,SAAS,CAAE,MAAO,CAAAA,SAAS,CAC/B,GAAI,MAAO,CAAAI,YAAY,GAAK,WAAW,CAAE,CACvC,MAAO,CAAAA,YAAY,CAACC,OAAO,CAAC,YAAY,CAAC,CAC3C,CACA,MAAO,KAAI,CACb,CAAE,MAAAC,OAAA,CAAM,CACN,MAAO,CAAAN,SAAS,CAClB,CACF,CAEA,GAAI,CAAAO,YAAY,CAAG,IAAI,CACvB,MAAO,SAAS,CAAAC,kBAAkBA,CAACC,EAAE,CAAE,CAAEF,YAAY,CAAGE,EAAE,CAAE,CAE5D,KAAM,CAAAC,QAAQ,CAAGC,OAAO,CAACC,GAAG,CAACC,kBAAkB,EAAI,EAAE,CAErD,QAAS,CAAAC,UAAUA,CAACC,GAAG,CAAE,CACvB,GAAI,eAAe,CAACC,IAAI,CAACD,GAAG,CAAC,CAAE,MAAO,CAAAA,GAAG,CACzC,GAAI,CAACL,QAAQ,CAAE,MAAO,CAAAK,GAAG,CACzB,GAAIA,GAAG,CAACE,UAAU,CAAC,GAAG,CAAC,CAAE,MAAO,CAAAP,QAAQ,CAAGK,GAAG,CAC9C,MAAO,CAAAL,QAAQ,CAAG,GAAG,CAAGK,GAAG,CAC7B,CAEA,cAAe,CAAAG,IAAIA,CAACC,MAAM,CAAEJ,GAAG,CAAEK,IAAI,CAAE,CACrC,GAAI,CACF,KAAM,CAAAC,OAAO,CAAGD,IAAI,CAAAE,aAAA,IAAQvB,WAAW,EAAK,CAAC,CAAC,CAC9C,KAAM,CAAAG,KAAK,CAAGC,YAAY,CAAC,CAAC,CAC5B,GAAID,KAAK,CAAEmB,OAAO,CAAC,eAAe,CAAC,WAAAE,MAAA,CAAarB,KAAK,CAAE,CACvD,KAAM,CAAAsB,GAAG,CAAG,KAAM,CAAAC,KAAK,CAACX,UAAU,CAACC,GAAG,CAAC,CAAE,CACvCI,MAAM,CACNE,OAAO,CAAEK,MAAM,CAACC,IAAI,CAACN,OAAO,CAAC,CAACO,MAAM,CAAGP,OAAO,CAAGQ,SAAS,CAC1DT,IAAI,CAAEA,IAAI,CAAGU,IAAI,CAACC,SAAS,CAACX,IAAI,CAAC,CAAGS,SACtC,CAAC,CAAC,CACF,GAAI,CAACL,GAAG,CAACQ,EAAE,CAAE,CACX,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAT,GAAG,CAACS,IAAI,CAAC,CAAC,CAC7B,KAAM,CAAAC,GAAG,CAAG,GAAI,CAAAC,KAAK,CAACF,IAAI,UAAAV,MAAA,CAAYC,GAAG,CAACY,MAAM,CAAE,CAAC,CACnD,GAAI7B,YAAY,CAAEA,YAAY,CAAC2B,GAAG,CAAE,CAAEnB,GAAG,CAAEqB,MAAM,CAAEZ,GAAG,CAACY,MAAO,CAAC,CAAC,CAChE,KAAM,CAAAF,GAAG,CACX,CACA,GAAI3B,YAAY,CAAEA,YAAY,CAAC,IAAI,CAAE,CAAEQ,GAAG,CAAEqB,MAAM,CAAEZ,GAAG,CAACY,MAAO,CAAC,CAAC,CACjE;AACA,GAAIZ,GAAG,CAACY,MAAM,GAAK,GAAG,CAAE,MAAO,KAAI,CACnC,MAAO,CAAAZ,GAAG,CAACa,IAAI,CAAC,CAAC,CACnB,CAAE,MAAOC,CAAC,CAAE,CACV,GAAI/B,YAAY,CAAEA,YAAY,CAAC+B,CAAC,CAAE,CAAEvB,GAAI,CAAC,CAAC,CAC1C,KAAM,CAAAuB,CAAC,CACT,CACF,CAEA,MAAO,MAAM,CAAAC,QAAQ,CAAG,CACtB;AACAC,UAAU,CAAEA,CAAA,GAAMtB,IAAI,CAAC,KAAK,CAAE,mBAAmB,CAAC,CAClDuB,WAAW,CAAEA,CAACC,EAAE,CAAEC,OAAO,GAAKzB,IAAI,CAAC,KAAK,sBAAAK,MAAA,CAAuBmB,EAAE,EAAIC,OAAO,CAAC,CAC7EC,WAAW,CAAGD,OAAO,EAAKzB,IAAI,CAAC,MAAM,CAAE,mBAAmB,CAAEyB,OAAO,CAAC,CAEpE;AACAE,QAAQ,CAAEA,CAAA,GAAM3B,IAAI,CAAC,KAAK,CAAE,iBAAiB,CAAC,CAC9C4B,cAAc,CAAGH,OAAO,EAAKzB,IAAI,CAAC,MAAM,CAAE,iBAAiB,CAAEyB,OAAO,CAAC,CACrEI,cAAc,CAAEA,CAACL,EAAE,CAAEC,OAAO,GAAKzB,IAAI,CAAC,KAAK,oBAAAK,MAAA,CAAqBmB,EAAE,EAAIC,OAAO,CAAC,CAC9EK,cAAc,CAAGN,EAAE,EAAKxB,IAAI,CAAC,QAAQ,oBAAAK,MAAA,CAAqBmB,EAAE,CAAE,CAAC,CAE/D;AACAO,KAAK,CAAEA,CAACC,QAAQ,CAAEC,GAAG,GAAKjC,IAAI,CAAC,MAAM,CAAE,uBAAuB,CAAE,CAAEgC,QAAQ,CAAEC,GAAI,CAAC,CAAC,CAClFC,MAAM,CAAEA,CAAA,GAAMlC,IAAI,CAAC,MAAM,CAAE,wBAAwB,CAAC,CAEpD;AACAmC,UAAU,CAAGV,OAAO,EAAKzB,IAAI,CAAC,MAAM,CAAE,mBAAmB,CAAEyB,OAAO,CACpE,CAAC,CAED,MAAO,SAAS,CAAAW,cAAcA,CAACC,MAAM,CAAE,CACrC,GAAI,MAAO,CAAAA,MAAM,GAAK,QAAQ,CAAE,MAAO,CAAAA,MAAM,CAC7C;AACA,KAAM,CAAAC,GAAG,CAAGC,MAAM,CAACC,QAAQ,CAACH,MAAM,CAAC,CAAGA,MAAM,CAAG,CAAC,CAChD,cAAAhC,MAAA,CAAeiC,GAAG,CAACG,cAAc,CAAC9B,SAAS,CAAE,CAAE+B,qBAAqB,CAAE,CAAC,CAAEC,qBAAqB,CAAE,CAAE,CAAC,CAAC,EACtG,CAEA,MAAO,SAAS,CAAAC,cAAcA,CAACC,GAAG,CAAE,CAClC,GAAI,CACF,KAAM,CAAAC,CAAC,CAAG,GAAI,CAAAC,IAAI,CAACF,GAAG,CAAC,CACvB,MAAO,CAAAC,CAAC,CAACL,cAAc,CAAC,CAAC,CAC3B,CAAE,MAAAO,QAAA,CAAM,CACN,MAAO,CAAAH,GAAG,CACZ,CACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}