{"ast":null,"code":"import React,{useState}from'react';import{HotelAPI}from'../api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function QRPage(){const[merchantName,setMerchantName]=useState('Floki Hotel');const[refNo,setRefNo]=useState('Invoice Test');const[amount,setAmount]=useState(1);const[trxCode,setTrxCode]=useState('BG');const[cpi,setCpi]=useState('174379');// sandbox default paybill/business\nconst[size,setSize]=useState(300);const[qrData,setQrData]=useState('');const[loading,setLoading]=useState(false);const[error,setError]=useState('');async function generate(){setError('');setLoading(true);setQrData('');try{const payload={MerchantName:merchantName,RefNo:refNo,Amount:Number(amount)||1,TrxCode:trxCode,CPI:cpi,Size:String(size)};const res=await HotelAPI.generateQR(payload);const code=res&&res.QRCode;if(!code)throw new Error(res&&res.ResponseDescription?res.ResponseDescription:'No QRCode returned');setQrData(code);}catch(e){setError(e&&e.message?e.message:'Failed to generate QR');}finally{setLoading(false);}}return/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:720,margin:'1rem auto'},children:[/*#__PURE__*/_jsx(\"h2\",{style:{marginTop:0,color:'#1a2236'},children:\"Generate M-PESA QR\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'#6a708a'},children:\"Create a dynamic QR for customers to scan and pay. Defaults use sandbox values.\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'1fr 1fr',gap:16},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',fontSize:12,color:'#6a708a'},children:\"Merchant Name\"}),/*#__PURE__*/_jsx(\"input\",{value:merchantName,onChange:e=>setMerchantName(e.target.value),style:{width:'100%',padding:10,borderRadius:8,border:'1px solid #e1e4ee'}})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',fontSize:12,color:'#6a708a'},children:\"Reference\"}),/*#__PURE__*/_jsx(\"input\",{value:refNo,onChange:e=>setRefNo(e.target.value),style:{width:'100%',padding:10,borderRadius:8,border:'1px solid #e1e4ee'}})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',fontSize:12,color:'#6a708a'},children:\"Amount (Kshs)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:1,value:amount,onChange:e=>setAmount(e.target.value),style:{width:'100%',padding:10,borderRadius:8,border:'1px solid #e1e4ee'}})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',fontSize:12,color:'#6a708a'},children:\"Transaction Code\"}),/*#__PURE__*/_jsxs(\"select\",{value:trxCode,onChange:e=>setTrxCode(e.target.value),style:{width:'100%',padding:10,borderRadius:8,border:'1px solid #e1e4ee'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"BG\",children:\"BG: Buy Goods\"}),/*#__PURE__*/_jsx(\"option\",{value:\"PB\",children:\"PB: Pay Bill\"}),/*#__PURE__*/_jsx(\"option\",{value:\"SM\",children:\"SM: Send Money\"}),/*#__PURE__*/_jsx(\"option\",{value:\"SB\",children:\"SB: Send to Business\"}),/*#__PURE__*/_jsx(\"option\",{value:\"WA\",children:\"WA: Withdraw at Agent\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',fontSize:12,color:'#6a708a'},children:\"CPI (ShortCode/MSISDN)\"}),/*#__PURE__*/_jsx(\"input\",{value:cpi,onChange:e=>setCpi(e.target.value),style:{width:'100%',padding:10,borderRadius:8,border:'1px solid #e1e4ee'}})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',fontSize:12,color:'#6a708a'},children:\"Size (px)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:100,value:size,onChange:e=>setSize(e.target.value),style:{width:'100%',padding:10,borderRadius:8,border:'1px solid #e1e4ee'}})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:12,marginTop:16,alignItems:'center'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:generate,disabled:loading,style:{background:'#1a2236',color:'#fff',border:'none',borderRadius:8,padding:'10px 18px',fontWeight:700},children:loading?'Generatingâ€¦':'Generate QR'}),error&&/*#__PURE__*/_jsx(\"span\",{style:{color:'crimson',fontWeight:600},children:error})]}),qrData&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:24},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:0,color:'#1a2236'},children:\"QR Code\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'#6a708a'},children:\"Scan with M-PESA app to pay.\"}),/*#__PURE__*/_jsx(\"img\",{alt:\"M-PESA QR\",src:\"data:image/png;base64,\".concat(qrData),style:{width:size,height:size,border:'1px solid #e1e4ee',borderRadius:8}})]})]});}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}